<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Messenger</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <!-- AUTH SCREEN -->
  <div id="auth-screen" class="screen active">
    <div class="auth-container">
      <div class="auth-logo">
        <svg viewBox="0 0 48 48" width="120" height="120">
          <circle cx="24" cy="24" r="24" fill="#2AABEE"/>
          <path d="M10.7 23.2l22.8-9.4c1-.4 1.9.3 1.6 1.4l-3.9 18.3c-.3 1.2-1 1.5-2 .9l-5.6-4.1-2.7 2.6c-.3.3-.6.6-1.2.6l.4-5.7 10.3-9.3c.4-.4-.1-.6-.7-.2L16.4 26l-5.4-1.7c-1.2-.4-1.2-1.2.3-1.7z" fill="white"/>
        </svg>
      </div>
      <h1 class="auth-title">Messenger</h1>
      <p class="auth-subtitle" id="auth-subtitle">Войдите, чтобы продолжить</p>

      <form id="auth-form" class="auth-form">
        <div class="form-group" id="displayname-group" style="display:none">
          <input type="text" id="displayname-input" class="form-input" placeholder="Ваше имя" autocomplete="name">
        </div>
        <div class="form-group">
          <input type="text" id="username-input" class="form-input" placeholder="Имя пользователя (логин)" autocomplete="username">
        </div>
        <div class="form-group">
          <input type="password" id="password-input" class="form-input" placeholder="Пароль" autocomplete="current-password">
        </div>
        <div id="auth-error" class="auth-error"></div>
        <button type="submit" id="auth-btn" class="auth-btn">Войти</button>
      </form>

      <p class="auth-switch">
        <span id="auth-switch-text">Нет аккаунта?</span>
        <a href="#" id="auth-switch-link">Зарегистрироваться</a>
      </p>
    </div>
  </div>

  <!-- MAIN APP -->
  <div id="app-screen" class="screen">
    <div class="app-layout">
      <!-- SIDEBAR -->
      <div id="sidebar" class="sidebar">
        <div class="sidebar-header">
          <button class="icon-btn" id="menu-btn" title="Меню">
            <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
          </button>
          <div class="search-container">
            <svg class="search-icon" viewBox="0 0 24 24" width="20" height="20"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
            <input type="text" id="search-input" class="search-input" placeholder="Поиск">
          </div>
        </div>

        <div id="chat-list" class="chat-list">
          <div class="empty-state" id="no-chats">
            <p>Нет чатов</p>
            <p class="empty-hint">Найдите пользователя через поиск</p>
          </div>
        </div>

        <!-- Search results overlay -->
        <div id="search-results" class="search-results" style="display:none">
          <div class="search-results-header">Пользователи</div>
          <div id="search-results-list"></div>
        </div>
      </div>

      <!-- CHAT AREA -->
      <div id="chat-area" class="chat-area">
        <!-- Empty state -->
        <div id="chat-empty" class="chat-empty">
          <div class="chat-empty-icon">
            <svg viewBox="0 0 48 48" width="120" height="120">
              <circle cx="24" cy="24" r="24" fill="var(--accent)" opacity="0.15"/>
              <path d="M10.7 23.2l22.8-9.4c1-.4 1.9.3 1.6 1.4l-3.9 18.3c-.3 1.2-1 1.5-2 .9l-5.6-4.1-2.7 2.6c-.3.3-.6.6-1.2.6l.4-5.7 10.3-9.3c.4-.4-.1-.6-.7-.2L16.4 26l-5.4-1.7c-1.2-.4-1.2-1.2.3-1.7z" fill="var(--accent)" opacity="0.4"/>
            </svg>
          </div>
          <p class="chat-empty-text">Выберите чат для начала общения</p>
        </div>

        <!-- Chat view -->
        <div id="chat-view" class="chat-view" style="display:none">
          <div class="chat-header">
            <button class="icon-btn back-btn" id="back-btn">
              <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
            </button>
            <div class="chat-header-avatar" id="chat-avatar"></div>
            <div class="chat-header-info">
              <div class="chat-header-name" id="chat-name"></div>
              <div class="chat-header-status" id="chat-status"></div>
            </div>
            <div class="chat-header-actions">
              <button class="icon-btn" title="Поиск">
                <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
              </button>
              <button class="icon-btn" title="Ещё">
                <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/></svg>
              </button>
            </div>
          </div>

          <div class="messages-container" id="messages-container">
            <div class="messages-list" id="messages-list"></div>
          </div>

          <div class="typing-indicator" id="typing-indicator" style="display:none">
            <span class="typing-text" id="typing-text">печатает</span>
            <span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>
          </div>

          <div class="message-input-area">
            <button class="icon-btn emoji-btn" title="Эмодзи">
              <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"/></svg>
            </button>
            <div class="input-wrapper">
              <textarea id="message-input" class="message-input" placeholder="Сообщение" rows="1"></textarea>
            </div>
            <button class="send-btn" id="send-btn" title="Отправить">
              <svg viewBox="0 0 24 24" width="24" height="24"><path fill="currentColor" d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
